---
title: Clearhaus Transaction API Documentation
---

# Getting Started

To use this transaction API you must [be a technical
partner](https://www.clearhaus.com/psp-partner) (and such partners must be
PCI DSS L1).

<p class="alert alert-danger">
API keys come with many privileges so keep them secret.
</p>

## API endpoint

````
https://gateway.clearhaus.com      # live accounts
https://gateway.test.clearhaus.com # test accounts
````


## Authentication

Authentication is done via HTTP Basic Auth. Simply provide your API key as
username and a blank string as password. Remember a colon `:` after username
when using cURL to specify an empty password.

````shell
curl https://gateway.test.clearhaus.com \
     -u <your-api-key>:
````

You will get this response when you provide an invalid API key:

````http
HTTP/1.1 401 Not Authorized
````

## Resource discovery

The API follows [HATEOAS][HATEOAS] principle of REST which means all resources
are discoverable.

```shell
curl https://gateway.test.clearhaus.com \
     -u <your-api-key>:
```

```json
{
    "_links": {
        "authorizations": { "href": "/authorizations" },
        "account":        { "href": "/account" }
    }
}
```

## Response format
All responses will be delivered in JSON format (see [JSON-HAL][JSON-HAL]).

````
Content-Type: application/vnd.clearhaus-gateway.hal+json; version=0.10.0; charset=utf-8
````

where the version follows [Semantic Versioning](https://semver.org).

We use HTTP response codes to indicate API response status:

````
Number  Text
200     OK
201     Created
400     Bad Request
401     Unauthorized
404     Not Found
5xx     Server Error
````

## Accounts and keys

There are two types of accounts:

* A merchant account belongs to a merchant.
* A partner account belongs to you, i.e. a partner being tech-wise integrated
  into the transaction API.

Merchant accounts can process transactions whereas partner accounts cannot.

An API key (UUIDv4) points to an account (either a merchant account or a partner
account). An account can have multiple API keys pointing to it; this allows for
easy rolling of API keys. A merchant account usually uses one API key.

API keys can have an expire date. API keys can be enabled or disabled. For
merchant accounts, these details can be observed in the Clearhaus Dashboard.

A partner account API key can be a signing API key, meaning that it has a
verification key for verifying request signatures. This verification key is the
public part of an RSA key pair; the RSA key pair is generated by the partner.
The public part, the verification key, is communicated to Clearhaus during the
technical integration.

Only partner accounts have signing API keys.

## Signing requests

POST requests must be signed. Other requests can optionally be signed.

The signature is an RSA signature of the HTTP body; it is represented in hex.
The partner account is identified by the partner's signing API key.
Both the partner's signing API key and the RSA signature must be provided in a
`Signature` header together with `RS256-hex`:

```
Signature: <partner-signing-api-key> RS256-hex <signature>
```

<p class="alert alert-info">
<b>Notice:</b> If the signature header is included, it must hold a correct
signature, otherwise the transaction will fail.
</p>

### RSA signature

The RSA signature is an `RSASSA-PKCS1-v1_5` signature of the body. It is
represented in hex.

If the signing API key is `4390aec7-f76a-4c2f-8597-c87c2d06cb4f`, the signing
private key (in PEM format) is

```
-----BEGIN RSA PRIVATE KEY-----
MIIBOwIBAAJBALYK0zmwuYkH3YWcFNLLddx5cwDxEY7Gi1xITuQqRrU4yD3uSw+J
WYKknb4Tbndb6iEHY+e6gIGD+49TojnNeIUCAwEAAQJARyuYRRe4kcBHdPL+mSL+
Y0IAGkAlUyKAXYXPghidKD/v/oLrFaZWALGM2clv6UoYYpPnInSgbcud4sTcfeUm
QQIhAN2JZ2qv0WGcbIopBpwpQ5jDxMGVkmkVVUEWWABGF8+pAiEA0lySxTELZm8b
Gx9UEDRghN+Qv/OuIKFldu1Ba4f8W30CIQCaQFIBtunTTVdF28r+cLzgYW9eWwbW
pEP4TdZ4WlW6AQIhAMDCTUdeUpjxlH/87BXROORozAXocBW8bvJUI486U5ctAiAd
InviQqJd1KTGRDmWIGrE5YACVmW2JSszD9t5VKxkAA==
-----END RSA PRIVATE KEY-----
```

and the body is

```
amount=2050&currency=EUR&ip=1.1.1.1&card[pan]=4111111111111111&card[expire_month]=06&card[expire_year]=2022&card[csc]=123
```

then the `Signature` header should be

```
Signature: 4390aec7-f76a-4c2f-8597-c87c2d06cb4f RS256-hex 7ae0e14d35b2a15a7ff812a1899d7f0a5d28063f0c276081876a51fc3773f499459f944f8b57c6e0e76b47c218b20ebaad7c6250dcd1804dd19c87fb7f1216ba
```

In Ruby, you can calculate the RS256 hex signature using

```
key = OpenSSL::PKey::RSA.new(key_in_pem_string)
key.sign(OpenSSL::Digest.new('sha256'), body).unpack('H*').first
```

# Examples

## Charge a cardholder

To charge a cardholder you first have to reserve money on his bank account.
Next you can transfer money from his bank account to your merchant bank
account.


### Reserve money

The following will reserve EUR 20.50 (2050 cents) on cardholder's bank account:

````shell
curl -X POST https://gateway.test.clearhaus.com/authorizations \
     -u <your-api-key>: \
     -d "amount=2050"   \
     -d "currency=EUR"  \
     -d "ip=1.1.1.1"    \
     -d "card[pan]=4111111111111111" \
     -d "card[expire_month]=06"      \
     -d "card[expire_year]=2022"     \
     -d "card[csc]=123"              \
     -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "84412a34-fa29-4369-a098-0165a80e8fda",
    "status": {
        "code": 20000
    },
    "csc": {
        "present": true,
        "matches": true
    },
    "processed_at": "2018-07-09T12:58:56+00:00",
    "_links": {
        "captures": { "href": "/authorizations/84412a34-fa29-4369-a098-0165a80e8fda/captures" }
    }
}
````

In order to actually transfer money from cardholder's bank account to your
merchant bank account you will have to make a capture transaction.

<p class="alert alert-info">
<b>Notice:</b> Some issuers will approve authorizations although the CSC did not
match; in this case the <code>status</code> <code>code</code> will be
<code>20000</code> but <code>csc</code> <code>matches</code> will be
<code>false</code>. Please be aware that rules to disallow captures for such
authorizations may be in place for a merchant.
</p>

<p class="alert alert-info">
<b>Notice:</b> <code>csc</code> <code>matches</code> is <code>true</code> if
issuer or card scheme confirmed CSC to match; it is <code>false</code> if issuer
or card scheme did not perform validation or if validation failed.
</p>


### Withdraw money

The following will make a capture transaction and withdraw what you have
reserved on cardholder's bank account.

````shell
curl -X POST \
  https://gateway.test.clearhaus.com/authorizations/84412a34-fa29-4369-a098-0165a80e8fda/captures \
  -u <your-api-key>: \
  -H "Signature: <signing-api-key> RS256-hex <signature>"
````

You can withdraw a partial amount by providing an `amount` parameter:

````shell
curl -X POST \
  https://gateway.test.clearhaus.com/authorizations/84412a34-fa29-4369-a098-0165a80e8fda/captures \
  -u <your-api-key>: \
  -d "amount=1000"   \
  -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "d8e92a70-3030-4d4d-8ad2-684b230c1bed",
    "status": {
        "code": 20000
    },
    "processed_at": "2018-07-09T12:58:56+00:00",
    "amount": 1000,
    "_links": {
        "authorization": {
            "href": "/authorizations/84412a34-fa29-4369-a098-0165a80e8fda"
        },
        "refunds": {
            "href": "/authorizations/84412a34-fa29-4369-a098-0165a80e8fda/refunds"
        }
    }
}
````


## Refund to cardholder

You can refund all money or a partial amount of what you have withdrawn from
cardholder's bank account:

````shell
curl -X POST \
  https://gateway.test.clearhaus.com/authorizations/84412a34-fa29-4369-a098-0165a80e8fda/refunds \
  -u <your-api-key>: \
  -d "amount=500"    \
  -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "f04c0872-47ce-4683-8d8c-e154221bba14",
    "status": {
        "code": 20000
    },
    "processed_at": "2018-07-09T12:58:56+00:00",
    "amount": 500,
    "_links": {
        "authorization": { "href": "/authorizations/84412a34-fa29-4369-a098-0165a80e8fda" }
    }
}
````


## Payout to cardholder

Sometimes cardholders should receive money, e.g. if you wish to pay out some
winnings.

The following will transfer EUR 500.00 to cardholder's bank account from your
merchant bank account:

````shell
curl -X POST https://gateway.test.clearhaus.com/credits \
     -u <your-api-key>: \
     -d "amount=50000"  \
     -d "currency=EUR"  \
     -d "ip=1.1.1.1"    \
     -d "card[pan]=4111111111111111" \
     -d "card[expire_month]=06"      \
     -d "card[expire_year]=2022"     \
     -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "1b377999-bafb-42b0-a24f-106b312b0b40",
    "status": {
        "code": 20000
    },
    "processed_at": "2018-07-09T12:58:56+00:00",
    "amount": 50000,
    "currency": "EUR"
}
````

Depending on card scheme and merchant category, the name on the card might be
necessary for approval of credits. It may be provided through the optional
parameter `card[name]`.

## Series of transactions

Clearhaus supports two types of subscription billing:

* Recurring: Transactions processed at agreed, predetermined, regular intervals not
    exceeding 1 year; e.g. a monthly subscription for a magazine.
* Unscheduled (UCOF, Unscheduled Credential on File): Transactions not occurring
    on predetermined, regular intervals; e.g. a car sharing subscription
    billed weekly but only for weeks when the service is used.

For both types, there may be an agreed end of the series and the amount may be
varying. See the partner guideline for more details.

### Repeatedly reserve money

A first-in-series payment is created by making an authorization and
marking it as either a `recurring` or `unscheduled` series.
For instance, a first-in-series recurring payment could be made this way:

````shell
curl -X POST \
  https://gateway.test.clearhaus.com/authorizations \
  -u <your-api-key>:  \
  -d "amount=2050"    \
  -d "currency=EUR"   \
  -d "series[type]=recurring"     \
  -d "card[pan]=4111111111111111" \
  -d "card[expire_month]=06"      \
  -d "card[expire_year]=2026"     \
  -d "card[csc]=123"              \
  --data-urlencode "card[3dsecure][v2][rreq]=<some-rreq-value>" \
  -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "1b722683-92ad-4c6b-85da-e119d550670d",
    "status": { "code": 20000 },
    "series": {
        "type": "recurring",
        "tid": "481048839682954"
    }
}
````

This should be followed by a capture.

Subsequent-in-series authorizations initiated by the merchant are made
similarly, however, CSC is not included, and the previous-in-series is
referenced, e.g.:

````shell
curl -X POST \
  https://gateway.test.clearhaus.com/authorizations \
  -u <your-api-key>:  \
  -d "amount=2050"    \
  -d "currency=EUR"   \
  -d "series[previous][id]=1b722683-92ad-4c6b-85da-e119d550670d" \
  -d "card[pan]=4111111111111111" \
  -d "card[expire_month]=06"      \
  -d "card[expire_year]=2026"     \
  -H "Signature: <signing-api-key> RS256-hex <signature>"
````

A first-in-series authorization can also be made using the `applepay`,
`googlepay` or `mobilepayonline` payment methods.

A subsequent-in-series authorization must be made using the `card` payment
method with the exact card details of the referenced previous-in-series
authorization.

Any first-in-series authorization must be made with strong customer
authentication (SCA) regardless of the authorization amount (when the cardholder
is in scope for SCA).


## 3-D Secure

3-D Secure is a protocol designed to improve security for online transactions.
Before you continue please read more about this protocol at
[3dsecure.io](https://docs.3dsecure.io).

3-D Secure is the only way to achieve liability shift for fraud chargebacks.

### Secure transactions

To perform a 3-D Secure version 1 transaction you make an ordinary
authorization including a `pares` value:

````shell
curl -X POST https://gateway.test.clearhaus.com/authorizations \
     -u <your-api-key>: \
     -d "amount=2050"   \
     -d "currency=EUR"  \
     -d "ip=1.1.1.1"    \
     -d "card[pan]=4111111111111111" \
     -d "card[expire_month]=06"      \
     -d "card[expire_year]=2022"     \
     -d "card[csc]=123"              \
     --data-urlencode "card[3dsecure][v1][pares]=<some-pares-value>" \
     -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "84412a34-fa29-4369-a098-0165a80e8fda",
    "status": {
        "code": 20000
    },
    "processed_at": "2018-07-09T12:58:56+00:00",
    "3dsecure": {
        "version": "1.0.2",
        "status": "Y"
    }
}
````

To perform a 3-D Secure version 2 transaction you make an ordinary
authorization including an `ares` or an `rreq` value. The former is used in the
following example:

````shell
curl -X POST https://gateway.test.clearhaus.com/authorizations \
     -u <your-api-key>: \
     -d "amount=2050"   \
     -d "currency=EUR"  \
     -d "ip=1.1.1.1"    \
     -d "card[pan]=4111111111111111" \
     -d "card[expire_month]=06"      \
     -d "card[expire_year]=2022"     \
     -d "card[csc]=123"              \
     --data-urlencode "card[3dsecure][v2][ares]=<some-ares-value>" \
     -H "Signature: <signing-api-key> RS256-hex <signature>"
````

Example response (snippet):

````json
{
    "id": "d0949241-1ee8-47da-a77c-d251fd9e1e88",
    "status": {
        "code": 20000
    },
    "processed_at": "2020-07-03T11:06:58+00:00",
    "3dsecure": {
        "version": "2.1.0",
        "status": "Y"
    }
}
````

<p class="alert alert-info">
  <b>Notice:</b> The response element <code>threed_secure</code> is deprecated,
  please use <code>3dsecure</code>.
</p>


## Fetch account information

Some basic account information can be fetched:

````shell
curl https://gateway.test.clearhaus.com/account \
     -u <your-api-key>:
````

Example response (snippet):

````json
{
    "merchant_id": "000000003000001",
    "name": "Merchant Ltd.",
    "country": "GB",
    "mcc": "1111",
    "descriptor": "merchant.com",
    "transaction_rules":"reject authorization if amount > 100 EUR and (not fully 3dsecure)",
    "acquirer": {
        "visa_bin": 438309,
        "mastercard_bin": 526571
    }
}
````

See [account resource](#account) documentation for further details.


# API Reference


## Resources

Our API offers six different resources:

- [Authorizations](#authorizations)
- [Captures](#captures)
- [Refunds](#refunds)
- [Voids](#voids)
- [Credits](#credits)
- [Account](#account)


### Authorizations

To reserve money on a cardholder's bank account you make a new authorization resource.

````
POST https://gateway.clearhaus.com/authorizations
````

Authorizations can be created using different payment methods:
`card`, `applepay`, `mobilepayonline`, `moto`, `vipps`.
Exactly one payment method must be used.

#### Parameters

<dl class="dl-vertical">
  <dt>amount
    <span class="type">[0-9]{1,10}</span>
  </dt>
  <dd>
    Amount in minor units of given currency (e.g. cents if in Euro).
  </dd>

  <dt>currency
    <span class="type">[A-Z]{3}</span>
  </dt>
  <dd>
    <a target="_blank" href="currencies.txt">3-letter currency code</a>. (Some exponents differ from ISO 4217.)
  </dd>

  <dt>credential_on_file
    <span class="type">(<code>store</code>|<code>use</code>)</span>
  </dt>
  <dd>
    Indicate if the payment credential (e.g. PAN and expiry) will be stored for
    future use where the payment credential is not provided by the
    cardholder but collected from (encrypted) storage.
    <br />
    <code>store</code>: The payment credential will be stored; it may only be
    stored if the authorization is approved.
    <br />
    <code>use</code>: The payment credential has already been stored and is now
    being used.
    <br />
    Default:
    <ul>
      <li><code>use</code>, if <code>initiator</code> is <code>merchant</code>
      (<code>store</code> is invalid),</li>
      <li><code>store</code>, if the authorization is first-in-series.</li>
    </ul>

    <div class="type">Optional</code>
  </dd>

  <dt>initiator
    <span class="type">(<code>cardholder</code>|<code>merchant</code>)</span>
  </dt>
  <dd>
    The initiator of the authorization. An authorization is initiated by the
    cardholder if the cardholder decided the transaction should be created.
    This is regardless of whether a stored payment credential is being used.
    <br />
    For compliance reasons there should be a previous approved transaction (for
    the combination of card and merchant) where
    <code>credential_on_file=store</code> before <code>initiator</code> may be
    <code>merchant</code>.
    <br />
    Default:
    <ul>
      <li><code>merchant</code>, if the authorization is
      subsequent-in-series (<code>cardholder</code> is invalid),</li>
      <li><code>cardholder</code>, otherwise.</li>
    </ul>

    <div class="type">Optional</div>
  </dd>

  <dt>ip
    <span class="type">[0-9.a-fA-F:]{3,45}</span>
  </dt>
  <dd>
    Cardholder's IP address. It must be a valid v4 or v6 address.
    <div class="type">Optional<br></div>
  </dd>

  <dt>reference
    <span class="type">[\x20-\x7E]{1,30}
      <a target="_blank" href= "https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">
        ASCII printable characters
      </a>
    </span>
  </dt>
  <dd>
    A reference to an external object, such as an order number.
    <div class="type">Optional</div>
  </dd>

  <dt>
    series[type]
    <span class="type">(<code>recurring</code>|<code>unscheduled</code>)</span>
  </dt>
  <dd>
    The type of series.
    <br />
    This parameter is used exactly when initiating a series. To create a
    subsequent-in-series authorization use <code>series[previous][...]</code>.
    <br />
    <code>recurring</code>: A series of transactions where the cardholder has
    explicitly agreed that the merchant may repeatedly charge the cardholder at
    regular, predetermined intervals that may not exceed 1 year.
    <br />
    <code>unscheduled</code>: A series of transactions where the cardholder has
    explicitly agreed that the merchant may repeatedly charge the cardholder at
    non-predetermined times, e.g. based on cardholder usage.

    <div class="type">Conditional. Cannot be present if <code>series[previous]</code> is present.</div>
  </dd>

  <dt>
    series[previous][id]
    <span class="type">[:UUIDv4:]</span>
  </dt>
  <dd>
    The Clearhaus authorization ID as a reference to the latest approved
    authorization in the series.
    <br />
    This parameter is used for a subsequent-in-series.
    To create a first-in-series authorization use <code>series[type]</code>.
    <br />
    Can be used only with payment method <code>card</code>.
    <br />
    If the latest approved authorization in the series was not processed via
    Clearhaus, after obtaining explicit approval from Clearhaus, you can
    provide raw scheme values; see
    <a href="#scheme-reference-to-series">Scheme reference to series</a>.

    <div class="type">Conditional. Cannot be present if <code>series[type]</code> is present.</div>
  </dd>

  <dt>text_on_statement
    <span class="type">[\x20-\x7E]{2,22}
      <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">
        ASCII printable characters
      </a>
    </span>
  </dt>
  <dd>
    Text that will be placed on cardholder's bank statement.
    <div class="type">May not be all digits, all same character, or all sequential characters (e.g. "abc")</div>
    <div class="type">Optional</div>
  </dd>

  <!-- deprecated -->
  <dt><strike>recurring</strike>
    <span class="type">(true|false)</span>
  </dt>
  <dd>
    Deprecated! Please use <code>series</code>.
    <br />
    <div class="type">Optional. Cannot be used with <code>series</code> or
    <code>initiator</code>.</div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> When <code>recurring</code> is used, Clearhaus automatically
  identifies if there was a previous-in-series and if that is the case uses the
  level of authentication (CSC, 3-D Secure, etc.) to conclude if the payment is
  a first-in-in-series or a subsequent-in-series recurring.
</p>

<p class="alert alert-info">
  <b>Notice:</b> Since <code>series[type]</code> cannot be supplied together
  with <code>series[previous]</code>, the type of a series cannot change.
</p>


##### Method: `card`

<dl class="dl-vertical">
  <dt>card[pan]
    <span class="type">[0-9]{12,19}</span>
  </dt>
  <dd>
    Primary account number of card to charge.
  </dd>
  <dt>card[expire_month]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>Expiry month of card to charge.</dd>
  <dt>card[expire_year]
    <span class="type">20[0-9]{2}</span>
  </dt>
  <dd>Expiry year of card to charge.</dd>
  <dt>card[csc]
    <span class="type">[0-9]{3}</span>
  </dt>
  <dd>
    Card Security Code.
    <div class="type">Optional when partner is trusted</div>
  </dd>
  <dt>
    card[3dsecure]
    <span class="type">dictionary</span>
  </dt>
  <dd>
    See <a href="#authentication-3dsecure">Authentication: [3dsecure]</a>.
    <div class="type">Optional</div>
  </dd>

  <!-- deprecated -->
  <dt><strike>card[pares]</strike>
    <span class="type">[:base64:]</span>
  </dt>
  <dd>
    Deprecated! Please use <code>card[3dsecure][v1][pares]</code>. <br />
    See more information at <a target="_blank" href="https://docs.3dsecure.io">3dsecure.io</a>
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> An authorization that includes
  <code>card[3dsecure][v1][pares]</code>, <code>card[3dsecure][v2][rreq]</code>,
  and/or <code>card[csc]</code> cannot be a subsequent-in-series authorization.
</p>


##### Method: `applepay`

Apple Pay requires the payment details (PAN, expiry, etc.) of the payment token
to be decrypted by a symmetric key.
Your systems must derive this symmetric key using the payment token's ephemeral
public key, the merchant's private key and the merchant ID. For this, we refer
to [our reference implementation](https://github.com/clearhaus/pedicel) written
in Ruby; see [Apple's documentation for the <code>PaymentToken</code>
object][ApplePay-PaymentToken] for more information.

<dl class="dl-vertical">
  <dt>applepay[payment_token]
    <span class="type">[:json:]</span>
  </dt>
  <dd>
    Full <code>PKPaymentToken</code> serialized as JSON, supplied as a string.
    <br>
    Example: <code>{"paymentData":{"version":"EC_v1","data":"<Base64>",...},"paymentMethod":{...},...}</code>
  </dd>
  <dt>applepay[symmetric_key]
    <span class="type">[:hex:]</span>
  </dt>
  <dd>
    Symmetric AES key (unique per transaction) that can decrypt
    <code>data</code> from the <code>PKPaymentToken</code>.
  </dd>
</dl>

Additionally, an Apple Pay authorization can be created using raw values from
a payment token:

<dl class="dl-vertical">
  <dt>applepay[raw][pan]
    <span class="type">[0-9]{12,19}</span>
  </dt>
  <dd>
    Primary account number of card to charge.
  </dd>
  <dt>applepay[raw][expire_month]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>
    Expiry month of card to charge.
  </dd>
  <dt>applepay[raw][expire_year]
    <span class="type">20[0-9]{2}</span>
  </dt>
  <dd>
    Expiry year of card to charge.
  </dd>
  <dt>applepay[raw][cryptogram]
    <span class="type">[:base64:]{28}</span>
  </dt>
  <dd>
    Online payment cryptogram. Found as <code>onlinePaymentCryptogram</code> in
    the payment token.
  </dd>
  <dt>applepay[raw][eci]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>
    Electronic Commerce Indicator. Found as <code>eciIndicator</code> in the
    payment token.
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> Signing is required to use the <code>applepay</code> payment
  method.
  <br />
  <b>Notice:</b> An authorization made with <code>applepay</code> is
  strongly authenticated (SCA in PSD2).
  <br />
  <b>Notice:</b> An authorization made with <code>applepay</code> may be 3-D
  Secured to some degree or not at all; this is indicated by the
  <code>eciIndicator</code> of the <code>applepay[payment_token]</code>.
  <br />
  <b>Notice:</b> An authorization made with <code>applepay</code> cannot be a
  subsequent-in-series authorization.
  <br />
  <b>Notice:</b> Clients using <code>applepay[raw]</code> are responsible for
  verifying the payment token's signature, decrypting the token's payment data,
  validating the format of the fields in the payment data, etc. The procedure
  is available in Apple Pay's
  <a href="https://developer.apple.com/library/archive/documentation/PassKit/Reference/PaymentTokenJSON/PaymentTokenJSON.html">Payment Token Format Reference</a>.
</p>

##### Method: `googlepay`

To accept a payment using Google Pay, the complete payment token, recipient ID
and derived shared secret, are required. Please refer to the [official
documentation][GooglePay-PaymentCryptography]. Only protocol version `ECv2` is
supported.

<dl class="dl-vertical">
  <dt>googlepay[token]
    <span class="type">[:json:]</span>
  </dt>
  <dd>
    Raw payment method token as received in response from Google. UTF-8 encoded
    serialization of a JSON dictionary.
  </dd>
  <dt>googlepay[shared_key]
    <span class="type">[:base64:]</span>
  </dt>
  <dd>
    The shared secret derived from the ephemeral public key and your private
    key.
  </dd>
  <dt>googlepay[recipient_id]
    <span class="type">[\x21-\x7E]+
      <a target="_blank" href="http://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">ASCII printable characters</a> excluding space
    </span>
  </dt>
  <dd>
    The Google Pay recipient of the payload, e.g. <code>merchant:0123456789</code>.
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> Signing is required to use the <code>googlepay</code> payment
  method.
  <br />
  <b>Notice:</b> An authorization made with <code>googlepay</code> is strongly
  authenticated (SCA in PSD2) if <code>authMethod</code> is
  <code>CRYPTOGRAM_3DS</code> and the Google Pay guidelines for SCA 
  (<a href="https://developers.google.com/pay/api/web/guides/resources/sca">link</a>)
  have been followed.

  If <code>authMethod</code> is <code>PAN_ONLY</code>, a 3-D Secure flow is
  required for SCA.
  <br />
  <b>Notice:</b> An authorization made with <code>googlepay</code> cannot be a
  subsequent-in-series authorization.
  <br />
  <b>Notice:</b> The <code>recipient_id</code> for the <code>googlepay</code>
  test environment is <code>merchant:12345678901234567890</code>.
</p>

##### Method: `mobilepayonline`

<dl class="dl-vertical">
  <dt>mobilepayonline[pan]
    <span class="type">[0-9]{12,19}</span>
  </dt>
  <dd>
    Primary account number of card to charge.<br />
    If <code>payment_token</code> parameter is included, the <code>pan</code> must be a Token PAN.
  </dd>
  <dt>mobilepayonline[expire_month]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>
    Expiry month of card to charge.
  </dd>
  <dt>mobilepayonline[expire_year]
    <span class="type">[0-9]{4}</span>
  </dt>
  <dd>
    Expiry year of card to charge.
  </dd>
  <dt>mobilepayonline[payment_token]
    <span class="type">[:json:]</span>
  </dt>
  <dd>
    Full tokenCallback response serialized as JSON, supplied as a string.
    Required for token-based authentication.
    <br>
    Example: <code>{"paymentId":"string","tokenData":{"cryptogramInfo":{...},...},...}</code>
    <div class="type">Optional</div>
  </dd>
  <dt>mobilepayonline[phone_number]
    <span class="type">[\x20-\x7E]{1,15}</span>
  </dt>
  <dd>
    Phone number from where the PAN originates.
    <div class="type">Optional</div>
  </dd>
  <dt>
    mobilepayonline[3dsecure]
    <span class="type">dictionary</span>
  </dt>
  <dd>
    See <a href="#authentication-3dsecure">Authentication: [3dsecure]</a>.
    <div class="type">Optional</div>
  </dd>

  <!-- deprecated -->
  <dt><strike>mobilepayonline[pares]</strike>
    <span class="type">[:base64:]</span>
  </dt>
  <dd>
    Deprecated! Please use <code>mobilepayonline[3dsecure][v1][pares]</code>. <br />
    See more information at <a target="_blank" href="https://docs.3dsecure.io">3dsecure.io</a>
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> Signing is required to use the <code>mobilepayonline</code>
  payment method.
  <br />
  <b>Notice:</b> An authorization made with <code>mobilepayonline</code> is
  strongly authenticated (SCA in PSD2).
</p>

##### Method: `moto`

<dl class="dl-vertical">
  <dt>moto[pan]
    <span class="type">[0-9]{12,19}</span>
  </dt>
  <dd>
    Primary account number of card to charge.<br />
  </dd>
  <dt>moto[expire_month]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>
    Expiry month of card to charge.
  </dd>
  <dt>moto[expire_year]
    <span class="type">[0-9]{4}</span>
  </dt>
  <dd>
    Expiry year of card to charge.
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> Signing is required to use the <code>moto</code> payment
  method.
  <br />
  <b>Notice:</b> Neither <code>series[]</code> (nor <code>recurring</code>)
  nor <code>credential_on_file</code> is supported.
  Also, <code>initiator</code> cannot be <code>merchant</code>.
</p>

##### Method: `vipps`

<dl class="dl-vertical">
  <dt>vipps[pan]
    <span class="type">[0-9]{12,19}</span>
  </dt>
  <dd>
    Primary account number of card to charge.<br />
  </dd>
  <dt>vipps[expire_month]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>
    Expiry month of card to charge.
  </dd>
  <dt>vipps[expire_year]
    <span class="type">[0-9]{4}</span>
  </dt>
  <dd>
    Expiry year of card to charge.
  </dd>
  <dt>vipps[payment_token]
    <span class="type">[:json:]</span>
  </dt>
  <dd>
    Full response serialized as JSON, supplied as a string.
    <br>
    Example: <code>{"pspTransactionId":"string","networkToken":{"cryptogram": "string",...},...}</code>
    <div class="type">Optional</div>
  </dd>
  <dt>
    vipps[3dsecure]
    <span class="type">dictionary</span>
  </dt>
  <dd>
    See <a href="#authentication-3dsecure">Authentication: [3dsecure]</a>.
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> Signing is required to use the <code>vipps</code>
  payment method.
  <br />
</p>

##### Authentication: `[3dsecure]`

Only one 3-D Secure version can be used for a given authorization.

<dl class="dl-vertical">
  <dt>
    [3dsecure][v1]
    <span class="type">dictionary</span>
  </dt>
  <dd>
    3-D Secure version 1.
    <div class="type">Optional. Cannot be present if <code>v2</code> is present.</div>
  </dd>
  <dt>
    [3dsecure][v2]
    <span class="type">dictionary</span>
  </dt>
  <dd>
    3-D Secure version 2, also known as EMV 3-D Secure.
    <div class="type">Optional. Cannot be present if <code>v1</code> is present.</div>
  </dd>
</dl>

##### Authentication: `[3dsecure][v1]`


<dl class="dl-vertical">
  <dt>
    [3dsecure][v1][pares]
    <span class="type">[:base64:]</span>
  </dt>
  <dd>
    See more information at <a target="_blank" href="https://docs.3dsecure.io">3Dsecure.io</a>.
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> A valid PARes can indicate three different levels:
  non-authenticated, attempted 3-D Secure, fully 3-D Secure.
</p>

##### Authentication: `[3dsecure][v2]`

<dl class="dl-vertical">
  <dt>
    [3dsecure][v2][ares]
    <span class="type">[:json:]</span>
  </dt>
  <dd>
    The 3-D Secure version 2 ARes containing <code>authenticationValue</code>, <code>dsTransID</code>, etc.
    <div class="type">Optional. Cannot be present if <code>rreq</code> is present.</div>
  </dd>
  <dt>
    [3dsecure][v2][rreq]
    <span class="type">[:json:]</span>
  </dt>
  <dd>
    The 3-D Secure version 2 RReq containing <code>authenticationValue</code>, <code>dsTransID</code>, etc.
    <div class="type">Optional. Cannot be present if <code>ares</code> is present.</div>
  </dd>
</dl>

##### Scheme reference to series

If the previous-in-series authorization was made via this API, you should use
`series[previous][id]` to reference it. If it was not made via this API, you
must obtain explicit approval from Clearhaus to use the raw scheme values
grouped in <code>series[previous][mastercard]</code> and
<code>series[previous][visa]</code>. This is relevant when moving a subscription
from another acquirer to Clearhaus or among Clearhaus accounts.

The Mastercard specific reference to the series contains the following parts.

<dl class="dl-vertical">
  <dt>
    series[previous][mastercard][type]
    <span class="type">(<code>recurring</code>|<code>unscheduled</code>)</span>
  </dt>
  <dd>
    The type of the existing series.
    <br />
    Default: <code>recurring</code>.

    <div class="type">
    Conditional.

    Cannot be present if
    <code>series[previous][id]</code> or
    any <code>series[previous][visa][...]</code>
    is present.
    </div>
  </dd>

  <dt>
    series[previous][mastercard][tid]
    <span class="type">[A-Za-z0-9]{3}[A-Za-z0-9]{6}[0-9]{4} {2}</span>
  </dt>
  <dd>
    Trace ID being the concatenation of values
    Data element 63 subfield 1 (Financial Network Code) (position 1-3),
    Data element 63 subfield 2 (Banknet Reference Number) (position 4-9),
    Data element 15 (Date, Settlement, in MMDD format) (position 10-13), and
    two spaces;
    to be used in Data Element 48, Subfield 63.

    <div class="type">
    Conditional.

    Required if
    any <code>series[previous][mastercard][...]</code>
    is present.

    Cannot be present if
    <code>series[previous][id]</code> or
    any <code>series[previous][visa][...]</code>
    is present.
    </div>
  </dd>

  <dt>
    series[previous][mastercard][exemption]
    <span class="type">(<code>fixed_amount_series</code>|<code>variable_amount_series</code>)</span>
  </dt>
  <dd>
    The <i>Mastercard exemption</i> is used to indicate if the series is 
    fixed-amount or a variable-amount.
    <ul>
      <li><code>fixed_amount_series</code>:
        The series is a fixed-amount series. (MPMI value <code>03</code>.)
      </li>
      <li><code>variable_amount_series</code>:
        The series is a variable-amount series. (MPMI value <code>01</code>.)
        A <i>Mastercard exemption</i> (not formally an acquirer exemption for
        SCA) indicating that the transaction is out of scope for SCA.
      </li>
    </ul>
    If the previous-in-series is a subsequent-in-series it should be equal to
    the <i>Mastercard exemption</i> applied for the previous-in-series.
    The value originates from Mastercard Data element 48, Subelement 22,
    Subfield 1.
    The value <code>01</code> indicates variable amount whereas <code>03</code>
    indicates fixed amount.

    <br />
    Clearhaus uses the same <i>Mastercard exemption</i> for an entire series
    when a previous-in-series authorization in the series is referenced via
    <code>series[previous][id]</code>.

    <div class="type">
    Conditional.

    Required if
    any <code>series[previous][mastercard][...]</code>
    is present.

    Cannot be present if
    <code>series[previous][id]</code> or
    any <code>series[previous][visa][...]</code>
    is present.
    </div>
  </dd>
</dl>

The Visa specific reference to the series contains the following parts.

<dl class="dl-vertical">
  <dt>
    series[previous][visa][type]
    <span class="type">(<code>recurring</code>|<code>unscheduled</code>)</span>
  </dt>
  <dd>
    The type of the existing series.
    <br />
    Default: <code>recurring</code>.

    <div class="type">
    Conditional.

    Cannot be present if
    <code>series[previous][id]</code> or
    any <code>series[previous][mastercard][...]</code>
    is present.
    </div>
  </dd>

  <dt>
    series[previous][visa][tid]
    <span class="type">[0-9]{15}</span>
  </dt>
  <dd>
    Transaction ID from Field 62.2 of the first-in-series or previous-in-series
    authorization; to be used in Field 125, Usage 2, Dataset ID 03.

    <div class="type">
    Conditional.

    Required if
    <code>series[previous][visa][type]</code>
    is present.

    Cannot be present if
    <code>series[previous][id]</code> or
    any <code>series[previous][mastercard][...]</code>
    is present.
    </div>
  </dd>
</dl>

<p class="alert alert-info">
  <b>Notice:</b> A series migrated to Clearhaus using these scheme references
  cannot be continued with the now deprecated <code>recurring</code> flag.
  Instead, the subsequent-in-series following an authorization created using
  scheme references must use <code>series[previous][id]</code> to point to the
  previous in series.
</p>


### Captures

To transfer money from a cardholder's bank account to your merchant bank
account you make a new capture resource. You can make multiple captures for an
authorization transaction.

````
POST https://gateway.clearhaus.com/authorizations/:id/captures
````

#### Parameters

<dl class="dl-vertical">
  <dt>amount
    <span class="type">[1-9][0-9]{1,9}</span>
  </dt>
  <dd>
    Amount in minor units of given currency (e.g. cents if in Euro).
    The full or remaining amount will be withdrawn if no amount is given.
    <div class="type">Optional</div>
  </dd>
  <dt>text_on_statement
    <span class="type">[\x20-\x7E]{2,22}
      <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">
        ASCII printable characters
      </a>
    </span>
  </dt>
  <dd>
    Text that will be placed on cardholder's bank statement. Overrides <code>text_on_statement</code> from authorization.
    <div class="type">May not be all digits, all same character, or all sequential characters (e.g. "abc")</div>
    <div class="type">Optional</div>
  </dd>
  <dt>travel
    <span class="type">dictionary</span>
  </dt>
  <dd>
    See <a href="#travel-data">Travel data</a>.
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
<b>Notice:</b> A capture cannot be made if the authorization is 180 days old or older.
</p>


##### Travel data

At most one type of travel data can be supplied for a capture; if `travel` is
supplied, it must include exactly one of `travel[car]`, `travel[flight]`, or
`travel[lodging]`.

For service type `[car]` (rental), the following parameter is relevant.

<dl class="dl-vertical">
  <dt>
    travel[car][pick_up_date]
    <span class="type">20[0-9]{2}-[0-9]{2}-[0-9]{2} (YYYY-MM-DD)</span>
  </dt>
  <dd>
    The agreed pick-up date; can be in the future or in the past.
  </dd>
</dl>

For service type `[flight]`, the following parameter is relevant.

<dl class="dl-vertical">
  <dt>
    travel[flight][departure_date]
    <span class="type">20[0-9]{2}-[0-9]{2}-[0-9]{2} (YYYY-MM-DD)</span>
  </dt>
  <dd>
    The departure date; can be in the future or in the past.
  </dd>
</dl>

For service type `[lodging]` the following parameter is relevant.

<dl class="dl-vertical">
  <dt>
    travel[lodging][check_in_date]
    <span class="type">20[0-9]{2}-[0-9]{2}-[0-9]{2} (YYYY-MM-DD)</span>
  </dt>
  <dd>
    The agreed check-in date; can be in the future or in the past.
  </dd>
</dl>


### Refunds

To refund money to a cardholder's bank account you make a new refund resource.
You can make multiple refunds for an authorization transaction.
#### Parameters

````
POST https://gateway.clearhaus.com/authorizations/:id/refunds
````

<dl class="dl-vertical">
  <dt>amount
    <span class="type">[1-9][0-9]{1,9}</span>
  </dt>
  <dd>
    Amount in minor units of given currency (e.g. cents if in Euro).
    The full or remaining amount will be refunded if no amount is given.
    <div class="type">Optional</div>
  </dd>
  <dt>text_on_statement
    <span class="type">[\x20-\x7E]{2,22}
      <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">
        ASCII printable characters
      </a>
    </span>
  </dt>
  <dd>
    Text that will be placed on cardholder's bank statement. Overrides <code>text_on_statement</code> from authorization.

    <div class="type">May not be all digits, all same character, or all sequential characters (e.g. "abc").</div>
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
<b>Notice:</b> A refund does not "free up" what is captured from the
authorization; that is, after authorizing 10, capturing 5 and refunding 5, you
can still only capture 5.
</p>

<p class="alert alert-info">
<b>Notice:</b> A refund cannot be made if the last capture is 180 days old.
</p>


### Voids

To release reserved money on a cardholder's bank account you make a new void
resource. A reservation usually lasts for at least seven days depending on
the issuing bank and is then automatically released.

#### Parameters

````
POST https://gateway.clearhaus.com/authorizations/:id/voids
````

No parameters are needed to make a new void transaction.

<p class="alert alert-info">
<b>Notice:</b> A void cannot be made if the authorization age is 30 days or more.
</p>


### Credits

To payout (e.g. winnings and not refunds) money to a cardholder's bank account
you make a new credit resource.

#### Parameters

````
POST https://gateway.clearhaus.com/credits
````

<dl class="dl-vertical">
  <dt>amount
    <span class="type">[1-9][0-9]{1,9}</span>
  </dt>
  <dd>
    Amount in minor units of given currency (e.g. cents if in Euro).
  </dd>
  <dt>currency
    <span class="type">[A-Z]{3}</span>
  </dt>
  <dd>
    <a target="_blank" href="currencies.txt">3-letter currency code</a>. (Some exponents differ from ISO 4217.)
  </dd>
  <dt>text_on_statement
    <span class="type">[\x20-\x7E]{2,22}
      <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">
        ASCII printable characters
      </a>
    </span>
  </dt>
  <dd>
    Text that will be placed on cardholder's bank statement.
    <div class="type">May not be all digits, all same character, or all sequential characters (e.g. "abc").</div>
    <div class="type">Optional</div>
  </dd>
  <dt>reference
    <span class="type">[\x20-\x7E]{1,30} <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">ASCII printable characters</a></span>
  </dt>
  <dd>
    A reference to an external object, such as an order number.
    <div class="type">Optional</div>
  </dd>
  <dt>card[pan]
    <span class="type">[0-9]{12,19}</span>
  </dt>
  <dd>
    Primary account number of card to charge.
  </dd>
  <dt>card[expire_month]
    <span class="type">[0-9]{2}</span>
  </dt>
  <dd>
    Expiry month of card to charge.
  </dd>
  <dt>card[expire_year]
    <span class="type">20[0-9]{2}</span>
  </dt>
  <dd>
    Expiry year of card to charge.
  </dd>
  <dt>card[csc]
    <span class="type">[0-9]{3}</span>
  </dt>
  <dd>
    Card Security Code.
    <div class="type">Optional</div>
  </dd>
  <dt>card[name]
    <span class="type">[A-Za-z0-9 ]{1,30}</span>
  </dt>
  <dd>
    Name on card.
    <div class="type">Optional</div>
  </dd>
</dl>

<p class="alert alert-info">
<b>Notice:</b> Implicitly, <code>initiator</code> is <code>merchant</code> and
<code>credential_on_file</code> is <code>use</code>.
</p>

### Account

The account resource holds basic merchant account information. Only `HTTP GET`
is supported for this endpoint.

````
GET https://gateway.clearhaus.com/account
````


#### Response parameters

<dl class="dl-vertical">
  <dt>merchant_id
    <span class="type">[0-9]{15}</span>
  </dt>
  <dd>
    Used for 3-D Secure and also for reference when talking to our support
    staff. For 3-D Secure it is important to represent this number with leading
    zeros.
  </dd>
  <dt>descriptor
    <span class="type">[\x20-\x7E]{0,22}
      <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">
        ASCII printable characters
      </a>
    </span>
  </dt>
  <dd>
    The default <code>text_on_statement</code>.
  </dd>
  <dt>name
    <span class="type">[\x20-\x7E]{0,20} <a target="_blank" href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">ASCII printable characters</a></span>
  </dt>
  <dd>
    Merchant company name.
  </dd>
  <dt>country
    <span class="type">[A-Z]{2}</span>
  </dt>
  <dd>
    ISO 3166-1 2-letter country code for merchant company.
  </dd>
  <dt>currency
    <span class="type">[A-Z]{3}</span>
  </dt>
  <dd>
    ISO 4217 3-letter currency code for merchant currency.
  </dd>
  <dt>mcc
    <span class="type">[0-9]{4}</span>
  </dt>
  <dd>
    Merchant category code.
  </dd>
  <dt>acquirer
  </dt>
  <dd>
    Used for 3-D Secure.
  </dd>
  <dt>transaction_rules
    <span class="type">[\x20-\x7E]*</span>
  </dt>
  <dd>
    The processing rules that the merchant's transactions must adhere to.
  </dd>
</dl>


## Transaction status codes

The JSON response will include one of following transaction status codes when
you make a new transaction.

Status     | `code` |  Meaning
---------- | ------ | --------
Approved   |  20000 |  Approved
Declined   |  40000 |  General input error
           |  40110 |  Invalid card number
           |  40111 |  Unsupported card scheme
           |  40120 |  Invalid CSC
           |  40130 |  Invalid expire date
           |  40135 |  Card expired
           |  40140 |  Invalid currency
           |  40150 |  Invalid text on statement
           |  40190 |  Invalid transaction
           |  40200 |  Clearhaus rule violation
           |  40300 |  3-D Secure problem
           |  40310 |  3-D Secure authentication failure
           |  40400 |  Backend problem
           |  40410 |  Declined by issuer or card scheme
           |  40411 |  Card restricted
           |  40412 |  Card lost or stolen
           |  40413 |  Insufficient funds
           |  40414 |  Suspected fraud
           |  40415 |  Amount limit exceeded
           |  40416 |  Additional authentication required
           |  40420 |  Merchant blocked by cardholder
           |  50000 |  Clearhaus error


### Status message

A status message may be included in the response when you create a new
transaction.
The status message can be used for debugging and may include a more specific
error message.

Status messages should be shown to the merchant.

Examples:

````json
{
    "status": {
        "code": 40000,
        "message": "parameter 'amount' is required"
    }
}

{
    "status": {
        "code": 40200,
        "message": "amount > 100 EUR and (not strongly authenticated)"
    }
}

{
    "status": {
        "code": 40200,
        "message": "not (fully 3dsecure or subsequent recurring)"
    }
}
````

### Merchant blocked by cardholder status

A _merchant blocked by cardholder_ status code is both a decline of the current
authorization, but also a notice to **halt all future
merchant-initiated-transactions** on this card from this merchant. This
includes, but is not limited to, recurring transactions.

Only after the blockade has been lifted, by actions taken by the cardholder,
may transactions be resumed.

## Test card numbers

For testing towards the test endpoint `gateway.test.clearhaus.com` please use
PANs that are either <b>not</b>
<a href="https://en.wikipedia.org/wiki/Luhn_algorithm">Luhn-compliant</a>, are
one of the special test PANs 2221000000000009, 4111111111111111,
5000000000000004, or are Apple Pay test cards.

For PANs starting with 420000 and ending with 0000, and PANs starting with
555555 and ending with 4444, you can specify a valid status `code` as
transaction amount to trigger the status.

When testing towards the test endpoint, the CSC 987&mdash;and only 987&mdash;is
considered a match for all PANs.

## Endpoint summary


````shell
# authorizations
https://gateway.clearhaus.com/authorizations

# captures
https://gateway.clearhaus.com/authorizations/:id/captures

# voids
https://gateway.clearhaus.com/authorizations/:id/voids

# refunds
https://gateway.clearhaus.com/authorizations/:id/refunds

# credits
https://gateway.clearhaus.com/credits

# account
https://gateway.clearhaus.com/account
````

## Changes

Follow coming changes on the [source code repository](https://github.com/clearhaus/gateway-api-docs).

Sorted by descending timestamp.

### Accept travel data

[Travel data](#travel-data) can be [supplied for a capture](#captures) as of 2022-xx-yy.

### Removing VES from supported currencies

The currency VES will not be supported after 2021-10-01T04:00:00Z.

### Update authorization parameters

Replace `recurring` with `series[type]=recurring` and add `series[previous]` as
a way of pointing to the previous-in-series authorization (either via a
Clearhaus authorization ID or via raw scheme values).

Add also two optional parameters `credential_on_file` and `initiator` to allow
for explicitly specifying if credential on file is being stored or used, and if
the transaction is merchant or cardholder initiated.

### Support for multiple signatures removed

Support for multiple signatures for request signing will be removed any time after 2020-10-31.

### 3-D Secure version 2 supported

Starting 2020-07-08 support for 3-D Secure version 2 has been added. See [3-D
Secure](#3-d-secure) and [Authentication:
[3dsecure]](#authentication-3dsecure).

### Deprecate `threed_secure` response element

The response element `threed_secure` is now deprecated; it will be available at
least until 2021-02-15.

### Optional name on card parameter added

Starting 2020-03-03 the optional parameter `card[name]` may be used to provide
the name on the card for credits. Depending on card scheme and merchant
category, the name might be necessary for approval.

### Request signing becomes mandatory

In the first quarter of 2020 signing of POST requests will become mandatory. We will work together with clients to ensure their requests are compliant before introducing enforcement of the requirement in the transaction gateway.

[JSON-HAL]: https://tools.ietf.org/html/draft-kelly-json-hal-08 "IETF HAL draft"
[HATEOAS]: https://en.wikipedia.org/wiki/HATEOAS
[Tokenization]: https://en.wikipedia.org/wiki/Tokenization_(data_security)
[ApplePay-PaymentToken]: https://developer.apple.com/library/content/documentation/PassKit/Reference/PaymentTokenJSON/PaymentTokenJSON.html
[GooglePay-PaymentCryptography]: https://developers.google.com/pay/api/web/guides/resources/payment-data-cryptography
